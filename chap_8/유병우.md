# Jotai

jotaiëŠ” atom ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ ì „ì—­ ìƒíƒœê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤. Reactì˜ ìƒíƒœ ê´€ë¦¬ë¥¼ ë‹¨ìˆœí™”í•˜ê³ , ì»´í¬ë„ŒíŠ¸ ê°„ì˜ ìƒíƒœ ê³µìœ ë¥¼ ì‰½ê²Œ í•´ì¤€ë‹¤.

## êµ¬ë¬¸ ë‹¨ìˆœí™”

ê¸°ì¡´ì—ëŠ” Contextì™€ Providerì™€ useStateë¥¼ í™œìš©í•´ì„œ ì „ì—­ ìƒíƒœë¥¼ ê´€ë¦¬í–ˆë‹¤ë©´, jotaiëŠ” atomì„ ì‚¬ìš©í•˜ì—¬ ìƒíƒœë¥¼ ì •ì˜í•˜ê³ , ì´ë¥¼ ì»´í¬ë„ŒíŠ¸ì—ì„œ ê°„ë‹¨í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìžˆë‹¤. atomì€ ìƒíƒœì˜ ë‹¨ìœ„ë¡œ, jotaiì—ì„œëŠ” atomì„ ìƒì„±í•˜ê³  ì´ë¥¼ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©í•˜ì—¬ ìƒíƒœë¥¼ ê´€ë¦¬í•œë‹¤.

```javascript
import { atom, useAtom } from "jotai";
const countAtom = atom(0);
const Counter = () => {
  const [count, setCount] = useAtom(countAtom);
  return (
    <div>
      <p>Count: {count}</p>
      <button onClick={() => setCount(count + 1)}>Increment</button>
    </div>
  );
};
```

ê¸°ì¡´ì´ì—ˆë‹¤ë©´

```javascript
import React, { useState, useContext } from "react";
const CountContext = React.createContext();
const CountProvider = ({ children }) => {
  const [count, setCount] = useState(0);
  return (
    <CountContext.Provider value={{ count, setCount }}>
      {children}
    </CountContext.Provider>
  );
};
const Counter = () => {
  const { count, setCount } = useContext(CountContext);
  return (
    <div>
      <p>Count: {count}</p>
      <button onClick={() => setCount(count + 1)}>Increment</button>
    </div>
  );
};
```

jotaië¥¼ ì‚¬ìš©í•˜ë©´ í›¨ì”¬ ê°„ë‹¨í•˜ê²Œ ìƒíƒœë¥¼ ê´€ë¦¬í•  ìˆ˜ ìžˆë‹¤.

## ë™ì  ì•„í†° ìƒì„±

jotaiëŠ” ì•„í†°ì´ ë˜ ë‹¤ë¥¸ ì•„í†°ì„ ì°¸ì¡°í•  ìˆ˜ ìžˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤. ì´ë¥¼ í†µí•´ ë™ì ìœ¼ë¡œ ì•„í†°ì„ ìƒì„±í•˜ê³ , ìƒíƒœë¥¼ ê´€ë¦¬í•  ìˆ˜ ìžˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì‚¬ìš©ìž ìž…ë ¥ì— ë”°ë¼ ì•„í†°ì„ ìƒì„±í•˜ê³ , ì´ë¥¼ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìžˆë‹¤.

```javascript
import { atom, useAtom } from "jotai";

const firstNameAtom = atom("");
const lastNameAtom = atom("");
const ageAtom = atom(0);

const userAtom = atom((get) => ({
  firstName: get(firstNameAtom),
  lastName: get(lastNameAtom),
  age: get(ageAtom),
}));
```

firstNameAtomë§Œ ì‚¬ìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ëŠ” firstNameAtomë§Œ êµ¬ë…í•˜ê³ , lastNameAtomê³¼ ageAtomì€ êµ¬ë…í•˜ì§€ ì•ŠëŠ”ë‹¤. ì´ë¥¼ í†µí•´ ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ì„ ë°©ì§€í•  ìˆ˜ ìžˆë‹¤.

ì´ëŠ” WeakMapì„ í™œìš©í•´ì„œ ì•„í†°ì˜ ìŠ¤í† ì–´ê°€ êµ¬í˜„ë˜ì–´ìžˆê¸° ë•Œë¬¸ì´ë‹¤.
ê·¸ì´ìœ ë¥¼ ê°„ë‹¨í•˜ê²Œ ì˜ì‚¬ ì½”ë“œë¡œ ì„¤ëª…í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

```javascript
const store = new WeakMap();
const createAtom = (initialValue) => {
  const atomKey = {};
  const currentAtom = {
    value: initialValue,
    subscribers: new Set(),
  };
  store.set(atomKey, currentAtom);
  return atomKey;
};

const useAtom = (atomKey) => {
  const currentAtom = store.get(atomKey);
  if (!currentAtom) {
    throw new Error("Atom not found");
  }
  // êµ¬ë… ë¡œì§
  return [
    currentAtom.value,
    (newValue) => {
      currentAtom.value = newValue;
      currentAtom.subscribers.forEach((subscriber) => subscriber(newValue));
    },
  ];
};
```

> ðŸ’¡ ì™œ store.delete(atom) ê°™ì€ ë©”ì„œë“œê°€ ì—†ëŠ”ê°€?
> âœ… WeakMapì€ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ì„ ì§€ì›í•˜ê¸° ë•Œë¬¸ì—, ë” ì´ìƒ ì°¸ì¡°ë˜ì§€ ì•ŠëŠ” ê°ì²´ëŠ” ìžë™ìœ¼ë¡œ ì‚­ì œëœë‹¤. ë”°ë¼ì„œ ë³„ë„ë¡œ ì‚­ì œ ë©”ì„œë“œë¥¼ ì œê³µí•  í•„ìš”ê°€ ì—†ìŒ!!

## íŒŒìƒ ìƒíƒœ

íŒŒìƒ ìƒíƒœëž€ ê¸°ì¡´ ìƒíƒœë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìƒˆë¡œìš´ ìƒíƒœë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. jotaiì—ì„œëŠ” íŒŒìƒ ìƒíƒœë¥¼ ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìžˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë‘ ê°œì˜ ì•„í†°ì„ í•©ì³ì„œ ìƒˆë¡œìš´ ì•„í†°ì„ ë§Œë“¤ ìˆ˜ ìžˆë‹¤.

```javascript
import { atom, useAtom } from "jotai";
const count1Atom = atom(0);
const count2Atom = atom(0);
const totalAtom = atom((get) => get(count1Atom) + get(count2Atom));
const Counter = () => {
  const [count1, setCount1] = useAtom(count1Atom);
  const [count2, setCount2] = useAtom(count2Atom);
  const [total] = useAtom(totalAtom);
  return (
    <div>
      <p>Count1: {count1}</p>
      <button onClick={() => setCount1(count1 + 1)}>Increment Count1</button>
      <p>Count2: {count2}</p>
      <button onClick={() => setCount2(count2 + 1)}>Increment Count2 </button>
      <p>Total: {total}</p>
    </div>
  );
};
```

## Providerì™€ Context

Context APIì²˜ëŸ¼ Providerë¡œ ì „ì—­ ìƒíƒœë¥¼ ì¼ë¶€ ìŠ¤ì½”í”„ë¡œ ì œí•œí•  ìˆ˜ ìžˆë‹¤.

```javascript
import { Provider } from "jotai";

const countAtom = atom(0);
const CountProvider = ({ children }) => {
  return <Provider>{children}</Provider>;
};

const Counter = () => {
  const [count, setCount] = useAtom(countAtom);
  return (
    <div>
      <p>Count: {count}</p>
      <button onClick={() => setCount(count + 1)}>Increment</button>
    </div>
  );
};

const App = () => (
  <>
    <CountProvider>
      <Counter />
      <Counter />
    </CountProvider>
    <CountProvider>
      <Counter />
      <Counter />
    </CountProvider>
  </>
);
```

1ë²ˆ, 2ë²ˆ ì¹´ìš´í„°ëŠ” ì„œë¡œ ê°™ì€ ìƒíƒœë¥¼ ê³µìœ í•˜ê³ ,3ë²ˆ, 4ë²ˆì¹´ìš´í„°ë„ ì„œë¡œ ê°™ì€ ìƒíƒœë¥¼ ê³µìœ í•œë‹¤. ê·¸ëŸ¬ë‚˜ (1, 2)ì™€ (3, 4)ëŠ” ì„œë¡œ ë‹¤ë¥¸ ìƒíƒœë¥¼ ê³µìœ í•œë‹¤. ì¦‰, jotaiëŠ” Context APIì²˜ëŸ¼ Providerë¡œ ì „ì—­ ìƒíƒœë¥¼ ì¼ë¶€ ìŠ¤ì½”í”„ë¡œ ì œí•œí•  ìˆ˜ ìžˆë‹¤.

## ë‹¤ì–‘í•œ ê¸°ëŠ¥ + ë¯¸ë“¤ì›¨ì–´

atomë‚´ get ì™¸ì—ë„ set, argsë¥¼ í™œìš©í•´ì„œ ë¯¸ë“¤ì›¨ì–´ë¥¼ êµ¬í˜„í•  ìˆ˜ ìžˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ìƒíƒœ ë³€ê²½ì„ ë¡œê¹…í•˜ëŠ” ë¯¸ë“¤ì›¨ì–´ë¥¼ ë§Œë“¤ ìˆ˜ ìžˆë‹¤.

```javascript
import { atom, useAtom } from "jotai";

const countAtom = atom(0, (get, set, newValue) => {
  console.log("State changed from:", get(countAtom), "to:", newValue);
  set(countAtom, newValue);
});

const Counter = () => {
  const [count, setCount] = useAtom(countAtom);

  return (
    <div>
      <p>Count: {count}</p>
      <button onClick={() => setCount(count + 1)}>Increment</button>
    </div>
  );
};
```

`useAtom`ì™¸ì—ë„ `useAtomValue`, `useSetAtom`, `useUpdateAtom` í›…ì„ ì œê³µí•˜ì—¬, ìƒíƒœë¥¼ ì½ê±°ë‚˜ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²•ì„ ë‹¤ì–‘í•˜ê²Œ ì œê³µí•œë‹¤. ì´ë¥¼ í†µí•´ ì»´í¬ë„ŒíŠ¸ì—ì„œ í•„ìš”í•œ ìƒíƒœë§Œ ì„ íƒì ìœ¼ë¡œ ê°€ì ¸ì˜¤ê³ , ì—…ë°ì´íŠ¸í•  ìˆ˜ ìžˆë‹¤.

```javascript
import { useAtomValue, useSetAtom } from "jotai";
const countAtom = atom(0);
const Counter = () => {
  const count = useAtomValue(countAtom);
  const setCount = useSetAtom(countAtom);
  return (
    <div>
      <p>Count: {count}</p>
      <button onClick={() => setCount(count + 1)}>Increment</button>
    </div>
  );
};
```
